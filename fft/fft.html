<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <title>module fft_mod</title>
   <link rel="stylesheet" href="http://www.gfdl.noaa.gov/~fms/style/doc.css" type="text/css">
   <meta http-equiv="Content-Type" content="text/html; charset=EUC-JP">
</head>
<body>
<font size=1 class="header">
<a href="#PUBLIC INTERFACE">PUBLIC INTERFACE </a>~
<a href="#PUBLIC ROUTINES">PUBLIC ROUTINES </a>~
<a href="#ERROR MESSAGES">ERROR MESSAGES </a>~
<a href="#REFERENCES">REFERENCES </a>~ 
<a href="#PRECOMPILER OPTIONS">PRECOMPILER OPTIONS </a>~ 
<a href="#LOADER OPTIONS">LOADER OPTIONS </a>~ 
<a href="#NOTES">NOTES</a>
</font><hr>


<h2>module fft_mod</h2>
<a name="HEADER"></a>
<!-- BEGIN HEADER -->
<div>
     <b>Contact:</b> &nbsp;  Bruce Wyman <br>
     <b>Reviewers:</b>&nbsp; <br>
     <b>Change History:&nbsp; </b><a HREF="http://www.gfdl.noaa.gov/fms-cgi-bin/cvsweb.cgi/FMS/shared/fft/fft.F90">WebCVS Log</a> <br>
     <b>Last Modified:</b>&nbsp; $Date: 2002/02/22 19:14:14 $
</div><br>

<!-- END HEADER -->
<!-------------------------------------------------------------------->
<a name="OVERVIEW"></a>
<hr>
<h4>OVERVIEW</h4>
<!-- BEGIN OVERVIEW -->
<p class="text">

     Performs simultaneous fast Fourier transforms (FFTs) between
     real grid space and complex Fourier space.

</p>
<!-- END OVERVIEW -->
<!-------------------------------------------------------------------->
<a name="DESCRIPTION"></a>
<!-- BEGIN DESCRIPTION -->
<div>
   <p>  This routine computes multiple 1-dimensional FFTs and inverse FFTs.
     There are 2d and 3d versions between type real grid point space
     and type complex Fourier space. There are single (32-bit) and
     full (64-bit) versions.</p>

    <p> On Cray and SGI systems, vendor-specific scientific library
     routines are used, otherwise a user may choose a NAG library version
     or stand-alone version using Temperton's FFT.</p>

</div>
<!-- END DESCRIPTION -->
<!-------------------------------------------------------------------->
<a name="OTHER MODULES USED"></a>
<hr>
<h4>OTHER MODULES USED</h4>
<!-- BEGIN OTHER MODULES USED -->
<div><pre>
platform_mod
     fms_mod
   fft99_mod
</pre></div>
<!-- END OTHER MODULES USED -->
<!-------------------------------------------------------------------->
<a name="PUBLIC INTERFACE"></a>
<hr>
<h4>PUBLIC INTERFACE</h4>
<!-- BEGIN PUBLIC INTERFACE -->
<div>
<pre>

<b>use fft_mod</b> [, only:  fft_init,
                      fft_exit,
                      fft_grid_to_fourier, 
                      fft_fourier_to_grid  ]


</pre>
<dl>
 <dt>  <a href="fft.html#fft_init">fft_init</a>:
     <dd>   This routine must be called to initialize the size of a
        single transform and setup trigonometric constants.

<dt>   <a href="fft.html#fft_exit">fft_exit</a>:
    <dd>    This routine is called to unset the transform size
        and deallocate memory.

<dt>   <a href="fft.html#fft_grid_to_fourier">fft_grid_to_fourier</a>:
    <dd>    Given multiple sequences of real data values, this routine
        computes the complex Fourier transform for all sequences.

<dt>   <a href="fft.html#fft_fourier_to_grid">fft_fourier_to_grid</a>:
    <dd>    Given multiple sequences of Fourier space transforms,
        this routine computes the inverse transform and returns
        the real data values for all sequences.

</dl></div><br>
<!-- END INTERFACE -->
<!-------------------------------------------------------------------->
<a name="PUBLIC ROUTINES"></a>
<hr>
<h4>PUBLIC ROUTINES</h4>
<!-- BEGIN PUBLIC ROUTINES -->
<ol type="a">
<li><a name="fft_init"></a><h4>fft_init</h4>
<pre>
<b>call fft_init</b> ( n )

DESCRIPTION
   This routine must be called once to initialize the size of a
   single transform. To change the size of the transform the
   routine fft_exit must be called before re-initialing with fft_init.

INPUT
   n    The number of real values in a single sequence of data.
        The resulting transformed data will have n/2+1 pairs of
        complex values.  <span class="type">[integer]</span>
</pre>
</li>
<li><a name="fft_exit"></a><h4>fft_exit</h4>

<pre>
<b>call fft_exit</b>

DESCRIPTION
   This routine is called to unset the transform size and
   deallocate memory. It can not be called unless fft_init
   has already been called. There are no arguments.
</pre>
</li>
<li><a name="fft_grid_to_fourier"></a><h4>fft_grid_to_fourier</h4>
<pre>
fourier = <b>fft_grid_to_fourier</b> ( grid )

DESCRIPTION
   Given multiple sequences of real data values, this routine
   computes the complex Fourier transform for all sequences.

INPUT
   grid    Multiple sequence of real data values. The first dimension
           must be n+1 (where n is the size of a single sequence).
             <span class="type">[real, dimension(n+1,:)]</span>
             <span class="type">[real, dimension(n+1,:,:)]</span>

RETURNS
   fourier   Multiple sequences of transformed data in complex Fourier space.
             The first dimension must equal n/2+1 (where n is the size
             of a single sequence). The remaining dimensions must be the
             same size as the input argument "grid".
               <span class="type">[complex, dimension(n/2+1,:)]</span>
               <span class="type">[complex, dimension(n/2+1,:,:)]</span>

NOTE

   The complex Fourier components are passed in the following format. 

        fourier (1)     = cmplx ( a(0), b(0) )
        fourier (2)     = cmplx ( a(1), b(1) )
            :              :       
            :              :       
        fourier (n/2+1) = cmplx ( a(n/2), b(n/2) )

   where n = length of each real transform
</pre>
<li><a name="fft_fourier_to_grid"></a><h4>fft_fourier_to_grid</h4>
<pre>
grid = <b>fft_fourier_to_grid</b> ( fourier )

DESCRIPTION
   Given multiple sequences of Fourier space transforms,
   this routine computes the inverse transform and returns
   the real data values for all sequences.

INPUT
    fourier  Multiple sequence complex Fourier space transforms.
             The first dimension must equal n/2+1 (where n is the
             size of a single real data sequence).
               <span class="type">[complex, dimension(n/2+1,:)]</span>
               <span class="type">[complex, dimension(n/2+1,:,:)]</span>

RETURNS
   grid    Multiple sequence of real data values. The first dimension
           must be n+1 (where n is the size of a single sequence).
           The remaining dimensions must be the same size as the input
           argument "fourier".
             <span class="type">[real, dimension(n+1,:)]</span>
             <span class="type">[real, dimension(n+1,:,:)]</span>

</pre></li>
</ol>
<!-- END PUBLIC ROUTINES -->
<!-------------------------------------------------------------------->
<a name="ERROR MESSAGES"></a>
<hr>
<h4>ERROR MESSAGES</h4>
<!-- BEGIN ERROR MESSAGES -->
<div>
<dl>
<dt><b>Errors in fft_grid_to_fourier or fft_fourier_to_grid</b>
    <dd><span class="errmsg">fft_init must be called</span></dd>
    <dd>   The initialization routine fft_init must be called before
        routines fft_grid_to_fourier or fft_fourier_to_grid.<br><br></dd>
<dt><b>Error in fft_grid_to_fourier</b>
    <dd><span class="errmsg">size of first dimension of input data is wrong</span></dd>
    <dd>  The real grid point field must have a first dimension
        equal to n+1 (where n is the size of each real transform).
        This message occurs when using the SGI/Cray fft.<br><br></dd>
    
    <dd><span class="errmsg">length of input data too small</span></dd>
    <dd>  The real grid point field must have a first dimension
        equal to n (where n is the size of each real transform).
        This message occurs when using the NAG or Temperton fft.
    <br><br></dd>
    <dd><span class="errmsg">float kind not supported for nag fft</span></dd>
     <dd> 32-bit real data is not supported when using the NAG fft.
       You may try modifying this part of the code by uncommenting the
       calls to the NAG library or less consider using the Temperton fft.
<br><br></dd>
<dt><b>Error in fft_fourier_to_grid</b>

 <dd>   <span class="errmsg">size of first dimension of input data is wrong</span></dd>
 <dd>     The complex Fourier field must have a first dimension
        equal to n/2+1 (where n is the size of each real transform).
        This message occurs when using the SGI/Cray fft.
<br><br></dd>
 <dd>   <span class="errmsg">length of input data too small</span></dd>
 <dd>     The complex Fourier field must have a first dimension greater
        than or equal to n/2+1 (where n is the size of each real transform).
        This message occurs when using the NAG or Temperton fft.
<br><br></dd>
  <dd>  <span class="errmsg">float kind not supported for nag fft</span></dd>
  <dd>    32-bit real data is not supported when using the NAG fft.
        You may try modifying this part of the code by uncommenting the
        calls to the NAG library or less consider using the Temperton fft.
<br><br></dd>
<dt><b>Errors in fft_init</b>
  <dd>  <span class="errmsg">attempted to reinitialize fft</span></dd>
  <dd>    You must call fft_exit before calling fft_init
        for a second time.
<br><br></dd>
<dt><b>Errors in fft_exit</b>
   <dd> <span class="errmsg">attempt to un-initialize fft that has not been initialized</span></dd>
   <dd>   You can not call fft_exit unless fft_init 
        has been called.</dd>
</dl>
</div><br>
<!-- END ERROR MESSAGES -->
<!-------------------------------------------------------------------->
<a name="REFERENCES"></a>
<hr>
<h4>REFERENCES</h4>
<!-- BEGIN REFERENCES -->
<div>
<ol>

<li>     For the SGI/Cray version refer to the manual pages for
     DZFFTM, ZDFFTM, SCFFTM, and CSFFTM.</li>

   <li>  For the NAG version refer to the NAG documentation for 
     routines C06FPF, C06FQF, and C06GQF.</li>

</ol>
</div><br>
<!-- END REFERENCES -->
<!-------------------------------------------------------------------->
<a name="PRECOMPILER OPTIONS"></a>
<hr>
<h4>PRECOMPILER OPTIONS</h4>
<!-- BEGIN PRECOMPILER OPTIONS -->
<div>
<dl>
<dt>-D<b>NAGFFT</b>
 <dd>  On non-Cray/SGI machines, set to use the NAG library FFT routines.
   Otherwise the Temperton FFT is used by default.
<br><br>
<dt>-D<b>test_fft</b>
 <dd>  Provides source code for a simple test program.
   The program generates several sequences of real data.
   This data is transformed to Fourier space and back to real data,
   then compared to the original real data.
</dl>
</div><br>
<!-- END PRECOMPILER OPTIONS -->
<!-------------------------------------------------------------------->
<a name="LOADER OPTIONS"></a>
<hr>
<h4>LOADER OPTIONS</h4>
<!-- BEGIN LOADER -->
<div>

    <p> On SGI machines the scientific library needs to be loaded by
     linking with:</p>
<pre>
        -lscs
</pre>
   <p>  If using the NAG library, the following loader options (or
     something similar) may be necessary:</p>
<pre>
        -L/usr/local/lib -lnag
</pre>
</div>
<!-- END LOADER OPTIONS -->
<!-------------------------------------------------------------------->
<a name="KNOWN BUGS"></a>
<hr>
<h4>KNOWN BUGS</h4>
<!-- BEGIN KNOWN BUGS -->
<div>

     None.

</div><br>
<!-- END KNOWN BUGS -->
<!-------------------------------------------------------------------->
<a name="NOTES"></a>
<hr>
<h4>NOTES</h4>
<!-- BEGIN NOTES -->
<div>
   <p>  The routines are overloaded for 2d and 3d versions.
     The 2d versions copy data into 3d arrays then calls the 3d interface.</p>
   <p>  On SGI/Cray machines:</p>
      <div>  There are single (32-bit) and full (64-bit) versions.
        For Cray machines the single precision version does not apply.</div>
   <br>
   <p>  On non-SGI/CRAY machines:</p>
      <div>
       <p> The NAG library option uses the "full" precision NAG
        routines (C06FPF,C06FQF,C06GQF). Users may have to specify
        a 64-bit real compiler option (e.g., -r8).</p>

       <p> The stand-alone Temperton FFT option works for the
        real precision specified at compile time.
        If you compiled with single (32-bit) real precision
        then FFT's cannot be computed at full (64-bit) precision.</p>
      </div>
</div>
<!-- END NOTES -->
<!-------------------------------------------------------------------->
<a name="FUTURE PLANS"></a>
<hr>
<h4>FUTURE PLANS</h4>
<!-- BEGIN FUTURE PLANS -->
<div>

      None.

</div><br>
<!-- END FUTURE PLANS -->
<!-------------------------------------------------------------------->

<hr>
</body>
</html>
